<% layout("layouts/boilerplate") %>

<div class="container py-5">
  <h3 class="mb-4 text-dark">Search results for "<span class="text-primary"><%= query %></span>"</h3>

  <% if (listings.length === 0) { %>
    <div class="alert alert-warning" role="alert">
      No listings found for "<strong><%= query %></strong>".
    </div>
  <% } else { %>
    <div class="list-group">
      <% listings.forEach(listing => { %>
        <a href="/listings/<%= listing._id %>" class="list-group-item list-group-item-action d-flex justify-content-between align-items-start shadow-sm mb-3 rounded">
          <div class="d-flex gap-3">
            <img 
              src="<%= listing.image?.url || '/images/fallback.jpg' %>" 
              alt="listing_image"
              class="img-thumbnail"
              style="width: 100px; height: 70px; object-fit: cover; border-radius: 5px;"
            />
            <div>
              <h5 class="mb-1"><%= listing.title %></h5>
              <p class="mb-1 text-muted small"><%= listing.description.length > 100 ? listing.description.slice(0, 100) + '...' : listing.description %></p>
              <div>
                <span class="fw-semibold">Rs <%= listing.price %></span>
                <small class="text-muted ms-2">+18% GST</small>
              </div>
            </div>
          </div>
          <div class="align-self-center">
            <button class="btn btn-outline-primary btn-sm">View</button>
          </div>
        </a>
      <% }); %>
    </div>
  <% } %>
</div>
